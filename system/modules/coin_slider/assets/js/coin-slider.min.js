/* Coin Slider 1.0 - @author Ivan Lazarevic - Licensed under MIT licence */
(function(b){var d=[],n=[],p=[],t=[],w=[],u=[],z=[],k=[],A=[],r=[],x=[];b.fn.coinslider=b.fn.CoinSlider=function(C){var D=function(a){var f=parseInt(d[a.id].width/d[a.id].spw),c=f,e=parseInt(d[a.id].height/d[a.id].sph),g=e,j=0,h=0,o=0,m,l,q=d[a.id].width-d[a.id].spw*c,y=q,B=d[a.id].height-d[a.id].sph*g;for(m=1;m<=d[a.id].sph;m++){y=q;if(B>0){B--;g=e+1}else g=e;for(l=1;l<=d[a.id].spw;l++){if(y>0){y--;c=f+1}else c=f;n[a.id][j]=m+""+l;j++;d[a.id].links?b("#"+a.id).append("<a href='"+t[a.id][0]+"' class='cs-"+
a.id+"' id='cs-"+a.id+m+l+"' style='width:"+c+"px; height:"+g+"px; float: left; position: absolute;'></a>"):b("#"+a.id).append("<div class='cs-"+a.id+"' id='cs-"+a.id+m+l+"' style='width:"+c+"px; height:"+g+"px; float: left; position: absolute;'></div>");b("#cs-"+a.id+m+l).css({"background-position":-h+"px "+(-o+"px"),left:h,top:o});h+=c}o+=g;h=0}b(".cs-"+a.id).mouseover(function(){b("#cs-navigation-"+a.id).show()});b(".cs-"+a.id).mouseout(function(){b("#cs-navigation-"+a.id).hide()});b("#cs-title-"+
a.id).mouseover(function(){b("#cs-navigation-"+a.id).show()});b("#cs-title-"+a.id).mouseout(function(){b("#cs-navigation-"+a.id).hide()});if(d[a.id].hoverPause){b(".cs-"+a.id).mouseover(function(){d[a.id].pause=true});b(".cs-"+a.id).mouseout(function(){d[a.id].pause=false});b("#cs-title-"+a.id).mouseover(function(){d[a.id].pause=true});b("#cs-title-"+a.id).mouseout(function(){d[a.id].pause=false})}},v=function(a){clearInterval(z[a.id]);z[a.id]=setInterval(function(){s(a)},d[a.id].delay+d[a.id].spw*
d[a.id].sph*d[a.id].sDelay)},s=function(a,f){if(d[a.id].pause!==true){E(a);r[a.id]=0;A[a.id]=setInterval(function(){var c=n[a.id][r[a.id]];b(".cs-"+a.id).attr("href",t[a.id][k[a.id]]).attr("target",w[a.id][k[a.id]]);if(r[a.id]==d[a.id].spw*d[a.id].sph)clearInterval(A[a.id]);else{b("#cs-"+a.id+c).css({opacity:0,"background-image":"url("+p[a.id][k[a.id]]+")"});b("#cs-"+a.id+c).animate({opacity:1},300);r[a.id]++}},d[a.id].sDelay);b(a).css({"background-image":"url("+p[a.id][k[a.id]]+")"});if(typeof f==
"undefined")k[a.id]++;else if(f=="prev")k[a.id]--;else k[a.id]=f;if(k[a.id]==p[a.id].length)k[a.id]=0;if(k[a.id]==-1)k[a.id]=p[a.id].length-1;b(".cs-button-"+a.id).removeClass("cs-active");b("#cs-button-"+a.id+"-"+(k[a.id]+1)).addClass("cs-active");if(u[a.id][k[a.id]]){b("#cs-title-"+a.id).css({opacity:0}).animate({opacity:d[a.id].opacity},d[a.id].titleSpeed);b("#cs-title-"+a.id).html(u[a.id][k[a.id]])}else b("#cs-title-"+a.id).css("opacity",0)}},F=function(a){var f;b(a).append("<div id='cs-navigation-"+
a.id+"'></div>");b("#cs-navigation-"+a.id).hide();b("#cs-navigation-"+a.id).append("<a href='#' id='cs-prev-"+a.id+"' class='cs-prev'>"+d[a.id].prevText+"</a>");b("#cs-navigation-"+a.id).append("<a href='#' id='cs-next-"+a.id+"' class='cs-next'>"+d[a.id].nextText+"</a>");b("#cs-prev-"+a.id).css({position:"absolute",top:d[a.id].height/2-15,left:0,"z-index":1001,"line-height":"30px",opacity:d[a.id].opacity}).click(function(c){c.preventDefault();s(a,"prev");v(a)}).mouseover(function(){b("#cs-navigation-"+
a.id).show()});b("#cs-next-"+a.id).css({position:"absolute",top:d[a.id].height/2-15,right:0,"z-index":1001,"line-height":"30px",opacity:d[a.id].opacity}).click(function(c){c.preventDefault();s(a);v(a)}).mouseover(function(){b("#cs-navigation-"+a.id).show()});b("<div id='cs-buttons-"+a.id+"' class='cs-buttons'></div>").appendTo(b("#coin-slider-"+a.id));for(f=1;f<p[a.id].length+1;f++)b("#cs-buttons-"+a.id).append("<a href='#' class='cs-button-"+a.id+"' id='cs-button-"+a.id+"-"+f+"'>"+f+"</a>");b.each(b(".cs-button-"+
a.id),function(c,e){b(e).click(function(g){b(".cs-button-"+a.id).removeClass("cs-active");b(this).addClass("cs-active");g.preventDefault();s(a,c);v(a)})});b("#cs-navigation-"+a.id+" a").mouseout(function(){b("#cs-navigation-"+a.id).hide();d[a.id].pause=false});b("#cs-buttons-"+a.id).css({left:"50%","margin-left":-p[a.id].length*15/2-5,position:"relative"})},E=function(a){var f=["random","swirl","rain","straight"],c,e,g;f=d[a.id].effect===""?f[Math.floor(Math.random()*f.length)]:d[a.id].effect;n[a.id]=
[];if(f=="random"){g=0;for(c=1;c<=d[a.id].sph;c++)for(e=1;e<=d[a.id].spw;e++){n[a.id][g]=c+""+e;g++}c=n[a.id];e=c.length;var j,h;if(e!==0)for(;--e;){g=Math.floor(Math.random()*(e+1));j=c[e];h=c[g];c[e]=h;c[g]=j}}if(f=="rain"){c=d[a.id].sph;e=d[a.id].spw;g=0;for(var o=h=j=1,m=true;m;){for(i=o;i<=j;i++){n[a.id][g]=i+""+parseInt(h-i+1);g++}h++;j<c&&h<e&&c<e&&j++;j<c&&c>=e&&j++;h>e&&o++;if(o>j)m=false}}if(f=="swirl"){c=d[a.id].sph;e=d[a.id].spw;j=g=1;var l=h=0;o=0;m=true;for(var q;m;){l=h===0||h===2?
e:c;for(q=1;q<=l;q++){n[a.id][o]=g+""+j;o++;if(q!=l)switch(h){case 0:j++;break;case 1:g++;break;case 2:j--;break;case 3:g--}}h=(h+1)%4;switch(h){case 0:e--;j++;break;case 1:c--;g++;break;case 2:e--;j--;break;case 3:c--;g--}l=(c<e?e:c)-(c>e?e:c);if(e<=l&&c<=l)m=false}}if(f=="straight"){f=0;for(c=1;c<=d[a.id].sph;c++)for(e=1;e<=d[a.id].spw;e++){n[a.id][f]=c+""+e;f++}}x[a.id]*=-1;x[a.id]>0&&n[a.id].reverse()},G=function(a){n[a.id]=[];p[a.id]=[];t[a.id]=[];w[a.id]=[];u[a.id]=[];k[a.id]=0;r[a.id]=0;x[a.id]=
1;d[a.id]=b.extend({},b.fn.coinslider.defaults,C);b.each(b("#"+a.id+" img"),function(f,c){p[a.id][f]=b(c).attr("src");t[a.id][f]=b(c).parent().is("a")?b(c).parent().attr("href"):"";w[a.id][f]=b(c).parent().is("a")?b(c).parent().attr("target"):"";u[a.id][f]=b(c).next().is("span")?b(c).next().html():"";b(c).hide();b(c).next().hide()});b(a).css({"background-image":"url("+p[a.id][0]+")",width:d[a.id].width,height:d[a.id].height,position:"relative","background-position":"top left"}).wrap("<div class='coin-slider' id='coin-slider-"+
a.id+"' />");b("#"+a.id).append("<div class='cs-title' id='cs-title-"+a.id+"' style='position: absolute; bottom:0; left: 0; z-index: 1000;'></div>");D(a);d[a.id].navigation&&F(a);s(a,0);v(a)};this.each(function(){G(this)})};b.fn.coinslider.defaults={width:565,height:290,spw:7,sph:5,delay:3E3,sDelay:30,opacity:0.7,titleSpeed:500,effect:"",navigation:true,links:true,hoverPause:true,prevText:"prev",nextText:"next"}})(jQuery);
